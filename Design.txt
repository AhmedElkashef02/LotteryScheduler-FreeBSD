Assignment 2 - Design and Implementation of Lottery Scheduler for FreeBSD System
Assignment By: Ahmed SalahEldin Farouk Elkashef 1410216

General Overview:
This assignment aims to implement lottery scheduling in FreeBSD that assigns each process’s threads some number of tickets (500), then randomly draws a ticket among those allocated to “ready” threads to decide which one to run. That thread is then allowed to run for a set time quantum, during which I/o may occur, or after which it is interrupted by a timer interrupt and this whole procedure is repeated. The number of tickets assigned to each thread determines the likelihood that it’ll run at each scheduling decision, and thus (over the long term) the relative amount of time that it gets to run. Threads that are more likely to get chosen each time will get chosen more often, and thus will get more CPU time.

Steps to Acheive lottery schduling:
- Change the mechanism that adds new threads to run queues so that they get chosen randomly, this mechanism only applies for user processes.
- Change the way a thread is chosen, by producing a new array for each runq with 10 random numbers, those random numbers are updated every 10 shceduling decisions. Thus, we indroduced a new variable "num_sched_decisions" that counts each time a scheduler successfully makes a decision.
- Add a gift() system call, that takes a target process, and a number of tickets. Deducts those tickets from the calling process, and donates them to the target process. This system call only works when gifting tickets is appliable and does not contradict with any of the restrictions of ticket transfer.
- initilize each thread with 500 tickets.
- restrict the number of tickets per thread to not less than 1, and not greater than 100,000 tickets.
- restrict the number of tickets per process to not less than 1, no maximum specified.
- determine if a thread should have its tickets increased or decreased depending on its "nice" value.
- add three new runqs for the user processes that will be dealt with using the lottery scheduling
- Used the arc4random() pseudo-random number generator, the function is used by the fills up the pool of random number 10 times and gets restarted again to fill new 10 random numbers and replace the existing ones. For more elaboration:
https://www.freebsd.org/cgi/man.cgi?query=arc4random&sektion=3

